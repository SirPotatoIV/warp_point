(this.webpackJsonpmern=this.webpackJsonpmern||[]).push([[0],{127:function(e,t,a){e.exports=a(251)},156:function(e,t){},158:function(e,t){},170:function(e,t){},172:function(e,t){},199:function(e,t){},201:function(e,t){},202:function(e,t){},207:function(e,t){},209:function(e,t){},228:function(e,t){},240:function(e,t){},243:function(e,t){},251:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(124),l=a.n(c),o=a(3),s=a(20),u=a(5),i=r.a.createContext(),m=a(4),d=a(10),b=a.n(d),f=a(21),p=a(8),E=a.n(p),v=a(30),h=a.n(v);function O(e){return g.apply(this,arguments)}function g(){return(g=Object(f.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E.a.post("/api/login",Object(m.a)({},t)).then((function(e){return e})).catch((function(e){return"Error"})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(){var e=Object(n.useContext)(i).setUser,t=Object(n.useState)(),a=Object(o.a)(t,2),c=a[0],l=a[1],s=Object(n.useState)(),m=Object(o.a)(s,2),d=m[0],p=m[1],E=Object(n.useState)({enabled:!1,route:""}),v=Object(o.a)(E,2),g=v[0],j=v[1],N=Object(n.useState)(!1),y=Object(o.a)(N,2),x=y[0],C=y[1],S=function(){var t=Object(f.a)(b.a.mark((function t(a){var n,r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.next=3,O({username:c,password:d});case 3:if("Error"!==(n=t.sent)){t.next=9;break}C(!0),setTimeout((function(){C(!1)}),3e3),t.next=13;break;case 9:return localStorage.setItem("userToken",JSON.stringify(n.data)),r=h.a.decode(n.data,"blackhole"),t.next=13,e(r);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement("div",{className:"container"},function(){if(g.enabled)return console.log("redirecting"),console.log(g.route),r.a.createElement(u.a,{to:g.route})}(),r.a.createElement("h1",{className:"bg-info text-white"},"Please Log In"),r.a.createElement("form",{className:"mb-5",onSubmit:S},r.a.createElement("label",null,r.a.createElement("p",null,"Username"),r.a.createElement("input",{type:"text",onChange:function(e){return l(e.target.value)}})),r.a.createElement("label",null,r.a.createElement("p",null,"Password"),r.a.createElement("input",{type:"password",onChange:function(e){return p(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("button",{type:"submit"},"Submit"))),r.a.createElement("div",{onClick:function(){return j({enabled:!0,route:"/register"})},className:"btn btn-primary"},"Register"),function(){if(x)return r.a.createElement("div",{className:"warning"},"Incorrect login credentials")}())}function N(e){return y.apply(this,arguments)}function y(){return(y=Object(f.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E.a.post("/api/register",Object(m.a)({},t)).then((function(e){return e})).catch((function(e){return"Error"})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){var e=Object(n.useContext)(i).setUser,t=Object(n.useState)({type:"customer"}),a=Object(o.a)(t,2),c=a[0],l=a[1],s=Object(n.useState)(!1),d=Object(o.a)(s,2),p=d[0],E=d[1],v=Object(n.useState)({enabled:!1,route:""}),O=Object(o.a)(v,2),g=O[0],j=O[1],y=function(){var t=Object(f.a)(b.a.mark((function t(a){var n,r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.next=3,N(Object(m.a)({},c));case 3:if(n=t.sent,console.log(n),!n.data.error){t.next=10;break}E(!0),setTimeout((function(){E(!1)}),3e3),t.next=15;break;case 10:return localStorage.setItem("userToken",JSON.stringify(n.data)),r=h.a.decode(n.data,"blackhole"),t.next=14,e(r);case 14:j({enabled:!0,route:"/"+n.data.type+"/dashboard"});case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement("div",{className:"container"},function(){if(g.enabled)return r.a.createElement(u.a,{to:g.route})}(),r.a.createElement("h1",{className:"bg-info text-white"},"Register New User"),r.a.createElement("form",{className:"mb-5",onSubmit:y},r.a.createElement("label",null,r.a.createElement("p",null,"Username"),r.a.createElement("input",{type:"text",onChange:function(e){return l(Object(m.a)(Object(m.a)({},c),{},{username:e.target.value}))}})),r.a.createElement("label",null,r.a.createElement("p",null,"Password"),r.a.createElement("input",{type:"password",onChange:function(e){return l(Object(m.a)(Object(m.a)({},c),{},{password:e.target.value}))}})),r.a.createElement("label",null,r.a.createElement("p",null,"Type"),r.a.createElement("select",{className:"p-1",type:"text",onChange:function(e){return l(Object(m.a)(Object(m.a)({},c),{},{type:e.target.value}))}},r.a.createElement("option",{value:"customer"},"Customer"),r.a.createElement("option",{value:"carrier"},"Carrier"),r.a.createElement("option",{value:"rep"},"Representative"))),r.a.createElement("label",null,r.a.createElement("p",null,"Company Name"),r.a.createElement("input",{type:"text",onChange:function(e){return l(Object(m.a)(Object(m.a)({},c),{},{companyName:e.target.value}))}})),r.a.createElement("label",null,r.a.createElement("p",null,"Location"),r.a.createElement("input",{type:"text",onChange:function(e){return l(Object(m.a)(Object(m.a)({},c),{},{location:e.target.value}))}})),r.a.createElement("label",null,r.a.createElement("p",null,"Phone Number"),r.a.createElement("input",{type:"number",onChange:function(e){return l(Object(m.a)(Object(m.a)({},c),{},{phone:e.target.value}))}})),r.a.createElement("div",null,r.a.createElement("button",{type:"submit"},"Submit"))),r.a.createElement("div",{onClick:function(){return j({enabled:!0,route:"/login"})},className:"btn btn-primary"},"Login"),function(){if(p)return r.a.createElement("div",{className:"warning"},"Failed to create user")}())}function C(){var e=Object(n.useContext)(i).setUser;return r.a.createElement("div",{onClick:function(){return localStorage.clear(),void e()},className:"inline btn btn-outline-dark"},"Logout")}var S=a(252);function k(e){var t=e.route,a=e.chart,c=Object(n.useState)(150),l=Object(o.a)(c,2),s=l[0],u=l[1],i=Object(n.useState)({xOffset:200,yOffset:70,width:400,height:250}),d=Object(o.a)(i,2),b=d[0],f=d[1];function p(e){var t=s+e/10;t>200?t=200:t<50&&(t=50),u(t)}return r.a.createElement("div",null,r.a.createElement("svg",{onMouseDown:function(e){return function(e){var t=e.pageX,a=e.pageY,n=b.xOffset,r=b.yOffset;function c(e){var c=n+(t-e.pageX),l=r+(a-e.pageY);c<100&&(c=100),l<0&&(l=0),c>500&&(c=500),l>250&&(l=250),f(Object(m.a)(Object(m.a)({},b),{},{xOffset:c,yOffset:l}))}document.addEventListener("mouseup",(function e(t){document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",e)})),document.addEventListener("mousemove",c)}(e)},onDragStart:function(){return!1},viewBox:b.xOffset+","+b.yOffset+","+b.width*(s/100)+","+b.height*(s/100),id:"svg_canvas",className:"svg border",width:"100%",height:"450",style:{backgroundImage:'url("https://images.unsplash.com/photo-1534796636912-3b95b3ab5986?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1351&q=80")'}},function(){var e=[];return a.map((function(t){return t.connections.filter((function(t){return!e[t]})).map((function(e){var n=a.find((function(t){return t.name===e.name}));return r.a.createElement("line",{key:Object(S.a)(),style:{stroke:"#cfe3cf",strokeWidth:1.5},x1:t.xCord,y1:t.yCord,x2:n.xCord,y2:n.yCord})}))}))}(),a.map((function(e){return r.a.createElement("circle",{name:e.name,key:e.name,cx:e.xCord,cy:e.yCord,r:"5",fill:"white"})})),function(){if(t)return t.map((function(e,a){if(t.length>a+1){return r.a.createElement("line",{key:Object(S.a)(),style:{stroke:"#008a09",strokeWidth:4},x1:e.xCord,y1:e.yCord,x2:t[a+1].xCord,y2:t[a+1].yCord})}return r.a.createElement("div",{key:Object(S.a)()})}))}(),function(){var e={fontSize:"0.6em",fill:"#000000",WebkitTouchCallout:"none",WebkitUserSelect:"none",khtmlUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",UserSelect:"none"};return a.map((function(t){return r.a.createElement("text",{style:e,key:t.name,x:t.xCord+.8,y:t.yCord-5.8},t.name)}))}(),function(){var e={fontSize:"0.6em",fill:"#a1c5ff",WebkitTouchCallout:"none",WebkitUserSelect:"none",khtmlUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",UserSelect:"none"};return a.map((function(t){return r.a.createElement("text",{style:e,key:t.name,x:t.xCord,y:t.yCord-5},t.name)}))}()),r.a.createElement("div",{className:"btn btn-info",style:{position:"relative",top:"-50px",left:"10px"},onClick:function(){return p(-100)}},"+"),r.a.createElement("div",{className:"btn btn-info",style:{position:"relative",top:"-50px",left:"20px",width:"35px"},onClick:function(){return p(100)}},"-"))}function w(e){var t=e.chart.map((function(e){return{value:e.name,label:e.name}})),a=Object(n.useContext)(i).user,c=Object(n.useState)(),l=Object(o.a)(c,2),s=l[0],d=l[1],p=Object(n.useState)(!1),v=Object(o.a)(p,2),h=v[0],O=v[1],g=Object(n.useState)(!1),j=Object(o.a)(g,2),N=j[0],y=j[1],x=Object(n.useState)([]),C=Object(o.a)(x,2),S=C[0],w=C[1],P=Object(n.useState)({enabled:!1,route:""}),U=Object(o.a)(P,2),D=U[0],T=U[1];Object(n.useEffect)((function(){e.chart.length>1&&d({startPoint:e.chart[0].name,endPoint:e.chart[0].name,customer:a.companyName})}),[e,a]);var _=function(){var e=Object(f.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),console.log(s),E.a.post("/api/order",Object(m.a)({},s)).then(function(){var e=Object(f.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t.data),T({enabled:!0,route:"/"});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,function(){if(D.enabled)return r.a.createElement(u.a,{to:D.route})}(),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement(k,{chart:e.chart,route:S}))),r.a.createElement("h3",{className:"bg-light rounded border"},"Create New Order"),r.a.createElement("form",{className:"mb-5",onSubmit:_},r.a.createElement("label",{className:"p-1"},r.a.createElement("p",null,"Shipping from:"),r.a.createElement("select",{className:"p-1",type:"text",onChange:function(e){return d(Object(m.a)(Object(m.a)({},s),{},{startPoint:e.target.value}))}},t.map((function(e){return r.a.createElement("option",{key:e.label,value:e.value},e.label)})))),r.a.createElement("label",{className:"p-1"},r.a.createElement("p",null,"Shipping to:"),r.a.createElement("select",{className:"p-1",type:"text",onChange:function(e){return d(Object(m.a)(Object(m.a)({},s),{},{endPoint:e.target.value}))}},t.map((function(e){return r.a.createElement("option",{key:e.label,value:e.value},e.label)})))),function(){if(!N)return r.a.createElement("div",null,r.a.createElement("button",{disabled:h,onClick:function(){return O(!0),void E.a.post("/api/starchart/calculate",{startPoint:s.startPoint,endPoint:s.endPoint}).then((function(e){w(e.data.route),d(Object(m.a)(Object(m.a)({},s),{},{distance:e.data.distance,customerCharge:e.data.customerCharge})),y(!0)}))}},"Calculate"))}(),function(){if(N)return r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Shipping Cost:"),r.a.createElement("span",null," $",s.customerCharge),r.a.createElement("div",null,r.a.createElement("button",{type:"submit"},"Submit")))}()))}function P(e){return r.a.createElement("div",null,r.a.createElement("h3",{className:"bg-light rounded border"},"Active Orders"),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row border-bottom"},r.a.createElement("div",{className:"col"},"Start Point"),r.a.createElement("div",{className:"col"},"End Point"),r.a.createElement("div",{className:"col"},"Distance"),r.a.createElement("div",{className:"col"},"Carrier Assigned"),r.a.createElement("div",{className:"col"},"Status")),e.displayOrders.map((function(e){return r.a.createElement("div",{key:Object(S.a)(),className:"row"},r.a.createElement("div",{key:Object(S.a)(),className:"col"},e.startPoint),r.a.createElement("div",{key:Object(S.a)(),className:"col"},e.endPoint),r.a.createElement("div",{key:Object(S.a)(),className:"col"},e.distance),r.a.createElement("div",{key:Object(S.a)(),className:"col"},e.carrier),r.a.createElement("div",{key:Object(S.a)(),className:"col"},e.status))}))))}function U(){var e=Object(n.useContext)(i).user,t=Object(n.useState)([]),a=Object(o.a)(t,2),c=a[0],l=a[1],s=Object(n.useState)([]),u=Object(o.a)(s,2),m=u[0],d=u[1];return Object(n.useEffect)((function(){E.a.get("/api/starchart").then((function(e){l(e.data)})).catch((function(e){console.log(e)}))}),[]),Object(n.useEffect)((function(){E.a.post("/api/order/search",{customer:e.companyName}).then((function(e){d(e.data)}))}),[e]),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row bg-info text-white"},r.a.createElement("div",{className:"col-9"},r.a.createElement("h1",{className:""},"Customer Dashboard for ",e.username)),r.a.createElement("div",{className:"col-3"},r.a.createElement(C,null))),r.a.createElement(w,{chart:c}),r.a.createElement(P,{displayOrders:m}))}function D(e){var t=Object(n.useState)({enabled:!1,route:""}),a=Object(o.a)(t,2),c=a[0],l=a[1];return r.a.createElement("div",{className:"container"},function(){if(c.enabled)return r.a.createElement(u.a,{to:c.route})}(),r.a.createElement("div",{className:"row border-bottom"},r.a.createElement("div",{className:"col"},"Start Point"),r.a.createElement("div",{className:"col"},"End Point"),r.a.createElement("div",{className:"col"},"Distance"),r.a.createElement("div",{className:"col"},"Carrier Assigned"),r.a.createElement("div",{className:"col"},"Status")),e.displayOrders.map((function(e){return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},e.startPoint),r.a.createElement("div",{className:"col"},e.endPoint),r.a.createElement("div",{className:"col"},e.distance),r.a.createElement("div",{className:"col"},e.carrier),r.a.createElement("div",{className:"col"},r.a.createElement("div",{onClick:function(e){return function(e){"active"===e.currentTarget.dataset.div_status&&E.a.put("/api/order/"+e.currentTarget.dataset.div_id,{status:"Complete"}).then((function(e){console.log(e.data),l({enabled:!0,route:"/"})})).catch((function(e){console.log(e)}))}(e)},"data-div_id":e._id,"data-div_status":e.status,className:"btn btn-info"},e.status)))})))}function T(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(0),s=Object(o.a)(l,2),m=s[0],d=s[1],b=Object(n.useContext)(i).user,f=Object(n.useState)({enabled:!1,route:""}),p=Object(o.a)(f,2),v=p[0],h=p[1];Object(n.useEffect)((function(){E.a.post("/api/order/search",{carrier:null}).then((function(e){c(e.data)})).catch((function(e){console.log(e)}))}),[]);var O=function(e){console.log(e.currentTarget.dataset.div_id),E.a.put("/api/order/"+e.currentTarget.dataset.div_id,{carrier:b.companyName,status:"active"}).then((function(e){console.log(e.data),h({enabled:!0,route:"/"})})).catch((function(e){console.log(e)}))};return r.a.createElement("div",null,function(){if(v.enabled)return r.a.createElement(u.a,{to:v.route})}(),r.a.createElement("h3",{className:"bg-light rounded border"},"Available Orders"),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row border-bottom"},r.a.createElement("div",{className:"col"},"Start Point"),r.a.createElement("div",{className:"col"},"End Point"),r.a.createElement("div",{className:"col"},"Distance"),r.a.createElement("div",{className:"col"})),function(){for(var e=[],t=10*m;t<10*m+10&&t<a.length;t++)e.push(a[t]);return e.map((function(e){return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},e.startPoint),r.a.createElement("div",{className:"col"},e.endPoint),r.a.createElement("div",{className:"col"},e.distance),r.a.createElement("div",{className:"col"},r.a.createElement("div",{"data-div_id":e._id,onClick:O,className:"m-1 px-5 btn btn-info"},"Claim")))}))}()),r.a.createElement("button",{onClick:function(){d(m-1)},disabled:!(m>0)||"",className:"btn btn-info mr-2"},"Previous page"),r.a.createElement("button",{onClick:function(){d(m+1)},disabled:!(a.length-10*m>10)||"",className:"btn btn-info px-4"},"Next page"))}function _(){var e=Object(n.useContext)(i).user,t=Object(n.useState)([]),a=Object(o.a)(t,2),c=a[0],l=a[1];return Object(n.useEffect)((function(){E.a.post("/api/order/search",{carrier:e.companyName}).then((function(e){l(e.data)}))}),[e]),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row bg-info text-white"},r.a.createElement("div",{className:"col-9"},r.a.createElement("h1",{className:""},"Carrier Dashboard for ",e.username)),r.a.createElement("div",{className:"col-3"},r.a.createElement(C,null))),r.a.createElement(T,null),r.a.createElement("h3",{className:"bg-light rounded border"},"Claimed Orders"),r.a.createElement(D,{displayOrders:c}))}function L(){var e=Object(n.useContext)(i).user;return r.a.createElement("div",{className:"container"},r.a.createElement("h1",null,"Representative Dashboard for ",e.username))}function I(e){var t=e.children;return Object(n.useContext)(i).user?t:r.a.createElement(u.a,{to:"/login"})}function W(e){var t=e.children,a=Object(n.useContext)(i).user;return a?r.a.createElement(u.a,{to:"/"+a.type+"/dashboard"}):t}var M=function(){var e=Object(n.useState)(),t=Object(o.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){var e=JSON.parse(localStorage.getItem("userToken"));if(e){var t=h.a.decode(e,"blackhole");c(t)}}),[]),r.a.createElement("div",{className:"app-container"},r.a.createElement(i.Provider,{value:{user:a,setUser:c}},r.a.createElement(s.a,null,r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/login"},r.a.createElement(W,null,r.a.createElement(j,null))),r.a.createElement(u.b,{exact:!0,path:"/register"},r.a.createElement(x,null)),r.a.createElement(u.b,{path:"/customer/dashboard"},r.a.createElement(I,null,r.a.createElement(U,null))),r.a.createElement(u.b,{path:"/carrier/dashboard"},r.a.createElement(I,null,r.a.createElement(_,null))),r.a.createElement(u.b,{path:"/rep/dashboard"},r.a.createElement(I,null,r.a.createElement(L,null))),r.a.createElement(u.a,{to:"/login"})))))};a(250);l.a.render(r.a.createElement(M,null),document.getElementById("root"))}},[[127,1,2]]]);
//# sourceMappingURL=main.28e45b13.chunk.js.map